---
title: "food_access"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
library(readxl)
library(dplyr)
library(tidycensus)
library(urbnmapr)
library(scales)
census_api_key("9f9584127dd506cdaf80bdb78927e9c01c12f2b8")
```

```{r Access, echo=FALSE}

states_stats <- urbnmapr::counties %>%
  select(long, lat, group, county_fips, state_abbv, county_name)

names(states_stats)[5] <- "state"

food_access <- read_xls("raw-data/DataDownload.xls", sheet = 5) %>%
  mutate_if(is.numeric, ~round(.,2)) %>%
  clean_names() %>%
  na.omit()

names(food_access)[1] <- "county_fips"

store_access <- read_xls("raw-data/DataDownload.xls", sheet = 6) %>%
  mutate_if(is.numeric, ~round(.,2))

food_stats <- left_join(states_stats, food_access, by = "county_fips")

write.csv(food_stats, file = "app/food_stats.csv")
```

```{r}
food_stats %>%
  filter(state.x == "AL") %>%
ggplot(mapping = aes(long, lat, group = group, fill = pct_laccess_pop15)) +
  geom_polygon(color = "#ffffff", size = .25) +
  coord_map(projection = "albers", lat0 = 39, lat1 = 45) +
  labs(fill = "Percent of population \n with low store access") +
  theme(legend.title = element_text(),
        legend.key.width = unit(.5, "in")) 

```
