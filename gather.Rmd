---
title: "State Data"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
library(readxl)
library(dplyr)
```

## Gathered Data by State

Gathered in my repo is data collected from both the CDC and United States Department of Agriculture Economic Research Service website. This week I have started working no the data from the CDC website which looks at statistics regarding obesity in the US. I have started to compile by states variables which store the progression in percentage of population who is obese or overweight, by gender, race and income. I made functions that would allow me to do that for each variable, and then assigned them to states. For the future of my app I hope to be able to produce maps and informational graphics demonstrating in what ways these statistics might be correlated with food access and physical activity statistics.

```{r, National, echo=FALSE}

national_stats <- read.csv("raw-data/Nutrition_Physical_Activity_and_Obesity.csv") %>%
  pivot_wider(names_from = "Question", values_from = "Data_Value") %>%
  subset(select = -c(Datasource, Topic, Class, Data_Value_Unit, Data_Value_Type, Data_Value_Alt, Data_Value_Footnote, Data_Value_Footnote_Symbol, Low_Confidence_Limit, High_Confidence_Limit, Total, Education, GeoLocation, ClassID, TopicID, QuestionID, DataValueTypeID, LocationID, StratificationCategory1, Stratification1, StratificationCategoryId1, StratificationID1))%>%
  clean_names() %>%
  rename(overweight = percent_of_adults_aged_18_years_and_older_who_have_an_overweight_classification, 
         no_phys_activity = percent_of_adults_who_engage_in_no_leisure_time_physical_activity, 
         hi_phys_active = percent_of_adults_who_achieve_at_least_150_minutes_a_week_of_moderate_intensity_aerobic_physical_activity_or_75_minutes_a_week_of_vigorous_intensity_aerobic_physical_activity_and_engage_in_muscle_strengthening_activities_on_2_or_more_days_a_week, 
         med_phys_active = percent_of_adults_who_achieve_at_least_300_minutes_a_week_of_moderate_intensity_aerobic_physical_activity_or_150_minutes_a_week_of_vigorous_intensity_aerobic_activity_or_an_equivalent_combination,
         mod_phys_active = percent_of_adults_who_achieve_at_least_150_minutes_a_week_of_moderate_intensity_aerobic_physical_activity_or_75_minutes_a_week_of_vigorous_intensity_aerobic_activity_or_an_equivalent_combination,
         obesity = percent_of_adults_aged_18_years_and_older_who_have_obesity, 
         fruit = percent_of_adults_who_report_consuming_fruit_less_than_one_time_daily, 
         vegetables = percent_of_adults_who_report_consuming_vegetables_less_than_one_time_daily) %>%
  subset(select = -percent_of_adults_who_engage_in_muscle_strengthening_activities_on_2_or_more_days_a_week) %>%
  arrange(location_abbr)

```

```{r functions, echo=FALSE}
get_female_obesity <- function(x){
  national_stats %>%
  filter(location_desc == x & gender == "Female" & !is.na(obesity)) %>%
  select(year_end, location_desc, sample_size, gender, obesity) %>%
  arrange(year_end)
}

get_female_overweight <- function(x){
  national_stats %>%
  filter(location_desc == x, gender == "Female" & !is.na(overweight)) %>%
  select(year_end, location_desc, sample_size, gender, overweight) %>%
  arrange(year_end)
}

get_male_overweight <- function(x){
  national_stats %>%
  filter(location_desc == x, gender == "Male" & !is.na(overweight)) %>%
  select(year_end, location_desc, sample_size, gender, overweight) %>%
  arrange(year_end)
}

get_male_obesity <- function(x){
  national_stats %>%
  filter(location_desc == x & gender == "Male" & !is.na(obesity)) %>%
  select(year_end, location_desc, sample_size, gender, obesity) %>%
  arrange(year_end)
}

get_race_obesity <- function(x){
  national_stats %>%
  filter(location_desc == x & !is.na(sample_size) & !is.na(race_ethnicity) & race_ethnicity != "" & !is.na(obesity)) %>%
  select(year_end, location_desc, sample_size, race_ethnicity, obesity) %>%
  arrange(year_end)
}

get_income_obesity <- function(x){
  national_stats %>%
  filter(location_desc == x & !is.na(sample_size) & !is.na(income) & income != "" & income != "Data not reported" & !is.na(obesity)) %>%
  select(year_end, location_desc, sample_size, income, obesity) %>%
  arrange(year_end)
}
```

```{r Alaska, echo=FALSE}
AK_female_obesity <- get_female_obesity("Alaska")

AK_male_obesity <- get_male_obesity("Alaska")

AK_female_overweight <- get_female_overweight("Alaska")

AK_male_overweight <- get_male_overweight("Alaska")

AK_race_obese <- get_race_obesity("Alaska")

AK_income_obese <- get_income_obesity("Alaska")
  
```

```{r Alabama, echo=FALSE}
AL_female_obesity <- get_female_obesity("Alabama")

AL_male_obesity <- get_male_obesity("Alabama")

AL_female_overweight <- get_female_overweight("Alabama")

AL_male_overweight <- get_male_overweight("Alabama")

AL_race_obese <- get_race_obesity("Alabama")

AL_income_obese <- get_income_obesity("Alabama")
```

```{r Arizona, echo=FALSE}
AZ_female_obesity <- get_female_obesity("Arizona")

AZ_male_obesity <- get_male_obesity("Arizona")

AZ_female_overweight <- get_female_overweight("Arizona")

AZ_male_overweight <- get_male_overweight("Arizona")

AZ_race_obese <- get_race_obesity("Arizona")

AZ_income_obese <- get_income_obesity("Arizona")
```

```{r Arkansas, echo=FALSE}
AR_female_obesity <- get_female_obesity("Arkansas")

AR_male_obesity <- get_male_obesity("Arkansas")

AR_female_overweight <- get_female_overweight("Arkansas")

AR_male_overweight <- get_male_overweight("Arkansas")

AR_race_obese <- get_race_obesity("Arkansas")

AR_income_obese <- get_income_obesity("Arkansas")
```

```{r California, echo=FALSE}
CA_female_obesity <- get_female_obesity("California")

CA_male_obesity <- get_male_obesity("California")

CA_female_overweight <- get_female_overweight("California")

CA_male_overweight <- get_male_overweight("California")

CA_race_obese <- get_race_obesity("California")

CA_income_obese <- get_income_obesity("California")
```

```{r Colorda, echo=FALSE}
CO_female_obesity <- get_female_obesity("Colorado")

CO_male_obesity <- get_male_obesity("Colorado")

CO_female_overweight <- get_female_overweight("Colorado")

CO_male_overweight <- get_male_overweight("Colorado")

CO_race_obese <- get_race_obesity("Colorado")

CO_income_obese <- get_income_obesity("Colorado")
```

```{r Connecticut, echo=FALSE}
CT_female_obesity <- get_female_obesity("Connecticut")

CT_male_obesity <- get_male_obesity("Connecticut")

CT_female_overweight <- get_female_overweight("Connecticut")

CT_male_overweight <- get_male_overweight("Connecticut")

CT_race_obese <- get_race_obesity("Connecticut")

CT_income_obese <- get_income_obesity("Connecticut")
```

```{r Delaware, echo=FALSE}
DE_female_obesity <- get_female_obesity("Delaware")

DE_male_obesity <- get_male_obesity("Delaware")

DE_female_overweight <- get_female_overweight("Delaware")

DE_male_overweight <- get_male_overweight("Delaware")

DE_race_obesity <- get_race_obesity("Delaware")

DE_income_obesity <- get_income_obesity("Delaware")
```

```{r Florida, echo=FALSE}
FL_female_obesity <- get_female_obesity("Florida")

FL_male_obesity <- get_male_obesity("Florida")

FL_female_overweight <- get_female_overweight("Florida")

FL_male_overweight <- get_male_overweight("Florida")

FL_race_obesity <- get_race_obesity("Florida")

FL_income_obesity <- get_income_obesity("Florida")
```

```{r Georgia, echo=FALSE}
GA_female_obesity <- get_female_obesity("Georgia")

GA_male_obesity <- get_male_obesity("Georgia")

GA_female_overweight <- get_female_overweight("Georgia")

GA_male_overweight <- get_male_overweight("Georgia")

GA_race_obesity <- get_race_obesity("Georgia")

GA_income_obesity <- get_income_obesity("Georgia")

```